# Improve response times 10x by introducing an interceptor in NestJS


`autocannon -d 10 -c 10 http://127.0.0.1:3000/before`

`autocannon -d 10 -c 10 http://127.0.0.1:3000/after`

## 5ms delay on a job 

─────────┬──────┬──────┬───────┬───────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%   │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼───────┼─────────┼─────────┼───────┤
│ Latency │ 5 ms │ 7 ms │ 22 ms │ 26 ms │ 8.42 ms │ 5.09 ms │ 96 ms │
└─────────┴──────┴──────┴───────┴───────┴─────────┴─────────┴───────┘
┌───────────┬────────┬────────┬────────┬────────┬────────┬───────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%  │ Avg    │ Stdev │ Min    │
├───────────┼────────┼────────┼────────┼────────┼────────┼───────┼────────┤
│ Req/Sec   │ 983    │ 983    │ 1084   │ 1232   │ 1104   │ 83.49 │ 983    │
├───────────┼────────┼────────┼────────┼────────┼────────┼───────┼────────┤
│ Bytes/Sec │ 235 kB │ 235 kB │ 259 kB │ 295 kB │ 264 kB │ 20 kB │ 235 kB │
└───────────┴────────┴────────┴────────┴────────┴────────┴───────┴────────┘

┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 1 ms │ 4 ms  │ 5 ms │ 1.37 ms │ 0.91 ms │ 17 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬────────┬────────┬─────────┬─────────┬─────────┬────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%     │ 97.5%   │ Avg     │ Stdev  │ Min    │
├───────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┼────────┤
│ Req/Sec   │ 2989   │ 2989   │ 5571    │ 5831    │ 5222    │ 848.27 │ 2989   │
├───────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┼────────┤
│ Bytes/Sec │ 715 kB │ 715 kB │ 1.33 MB │ 1.39 MB │ 1.25 MB │ 203 kB │ 714 kB │
└───────────┴────────┴────────┴─────────┴─────────┴─────────┴────────┴────────┘

## 10ms delay on a job 

┌─────────┬───────┬───────┬───────┬───────┬──────────┬─────────┬───────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev   │ Max   │
├─────────┼───────┼───────┼───────┼───────┼──────────┼─────────┼───────┤
│ Latency │ 10 ms │ 13 ms │ 25 ms │ 29 ms │ 14.05 ms │ 5.64 ms │ 96 ms │
└─────────┴───────┴───────┴───────┴───────┴──────────┴─────────┴───────┘
┌───────────┬────────┬────────┬────────┬────────┬────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%  │ Avg    │ Stdev   │ Min    │
├───────────┼────────┼────────┼────────┼────────┼────────┼─────────┼────────┤
│ Req/Sec   │ 540    │ 540    │ 690    │ 763    │ 685.4  │ 64.77   │ 540    │
├───────────┼────────┼────────┼────────┼────────┼────────┼─────────┼────────┤
│ Bytes/Sec │ 129 kB │ 129 kB │ 165 kB │ 182 kB │ 164 kB │ 15.5 kB │ 129 kB │
└───────────┴────────┴────────┴────────┴────────┴────────┴─────────┴────────┘

┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬───────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max   │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼───────┤
│ Latency │ 1 ms │ 1 ms │ 4 ms  │ 5 ms │ 1.35 ms │ 0.96 ms │ 25 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴───────┘
┌───────────┬────────┬────────┬─────────┬─────────┬─────────┬────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%     │ 97.5%   │ Avg     │ Stdev  │ Min    │
├───────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┼────────┤
│ Req/Sec   │ 2991   │ 2991   │ 5603    │ 5735    │ 5219.19 │ 804.28 │ 2991   │
├───────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┼────────┤
│ Bytes/Sec │ 715 kB │ 715 kB │ 1.34 MB │ 1.37 MB │ 1.25 MB │ 192 kB │ 715 kB │
└───────────┴────────┴────────┴─────────┴─────────┴─────────┴────────┴────────┘